import { Callout, Tab, Tabs } from 'nextra-theme-docs';

# ローカルで起動する

このページでははらちょをローカルで起動する方法をご紹介します。

<Callout type="warning">

ローカルでの起動は例外なく、以下の機能が利用できません。

- **_Kawaemon has given a new role_** (かわえもん自動ロール付与機能)

この機能は限界開発鯖、およびかわえもんしか利用できないので注意してください。

</Callout>

## リポジトリをクローンする

まずははらちょのリポジトリをクローンします。

<Tabs items={["HTTPS", "SSH", "GitHub CLI"]}>
<Tab>

HTTPS でクローンする場合は以下のコマンドを実行してください。

```bash
git clone https://github.com/approvers/OreOreBot2.git
```

</Tab>
<Tab>

SSH 経由でクローンする場合は以下のコマンドを実行してください。

```bash
git clone git@github.com:approvers/OreOreBot2.git
```

</Tab>
<Tab>

GitHub CLI 経由でクローンする場合は以下のコマンドを実行してください。

```bash
gh repo clone approvers/OreOreBot2
```

</Tab>
</Tabs>

## 依存関係をインストールする

依存関係をインストールします。

次のコマンドを実行します。

```bash
yarn
```

<Callout type="warning">

OreOreBot2 は Yarn v3 を使用しています。

使用している Yarn のバージョンが低すぎるとエラーが発生する可能性があります。

アップデートをお忘れなく。

</Callout>

## 環境変数を設定する

環境変数を設定します。ここでは、 `.env` で設定する例をご紹介します。

環境変数の詳細は [approvers/OreOreBot2 - 環境変数](https://github.com/approvers/OreOreBot2#%E7%92%B0%E5%A2%83%E5%A4%89%E6%95%B0) をご覧ください。

環境変数のサンプルファイルをコピーします。

```bash
cp .env.example .env
```

次に、 `.env` を編集します。

<Callout type="info">

.env の編集例

```env
DISCORD_TOKEN=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
MAIN_CHANNEL_ID=690909527461199922
GUILD_ID=683939861539192860
PREFIX=!
FEATURE=MESSAGE_CREATE,MESSAGE_UPDATE,COMMAND,VOICE_ROOM,ROLE,EMOJI
```

</Callout>

<Callout type="error">

トークンは絶対に外部に漏らさないでください

Token はあなたの Discord アカウントのパスワードと同義です。絶対外に漏洩しないようにしましょう。

</Callout>

## 起動する

次のコマンドを実行します。(デバックモードで起動します)

```bash
yarn dev
```

接続クライアント情報と依存関係レポートが表示されたら起動完了です。

```bash
============
起動完了しました
有効になっている機能> MESSAGE_CREATE, MESSAGE_UPDATE, COMMAND, VOICE_ROOM, ROLE, EMOJI
接続クライアント> m2en-debug-app
接続クライアントID> 1059902535873347624
接続クライアントバージョン> 1.32.0
discord.js バージョン> 14.7.1
--------------------------------------------------
Core Dependencies
- @discordjs/voice: 0.14.0
- prism-media: 1.3.4
Opus Libraries
- @discordjs/opus: 0.9.0
- opusscript: not found
Encryption Libraries
- sodium-native: not found
- sodium: not found
- libsodium-wrappers: not found
- tweetnacl: 1.0.3
FFmpeg
- version: 5.1.2
- libopus: yes
--------------------------------------------------
============
```

<Callout type="info">

ビルドしたものを起動する場合は以下のコマンドを実行します。

```bash
yarn build
yarn start
```

</Callout>
